<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Demo Máy Tính Tối Giản</title>
  <style>
    :root{
      --bg:#0f1720; --panel:#0b1220; --accent:#38bdf8; --muted:#94a3b8; --glass:rgba(255,255,255,0.04);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,#071029,#071826 60%); color:#e6eef6;
      padding:24px;
    }
    .card{
      width:360px; max-width:96vw; background:linear-gradient(180deg,var(--panel), rgba(7,20,38,0.9)); border-radius:12px; padding:18px; box-shadow:0 8px 30px rgba(2,6,23,0.6);
    }
    .title{font-size:16px; color:var(--muted); margin-bottom:8px}
    .display{
      background:var(--glass); border-radius:8px; padding:12px; min-height:54px; display:flex; align-items:center; justify-content:space-between; gap:12px;
      font-size:20px; font-weight:600; color:#f8fafc; margin-bottom:12px;
    }
    .display .expr{color:var(--muted); font-size:13px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap}
    .display .result{font-family:monospace; font-size:22px}
    .pad{display:grid; grid-template-columns:repeat(4,1fr); gap:10px}
    button.key{
      background:transparent; border:1px solid rgba(255,255,255,0.06); padding:12px; border-radius:8px; font-size:16px; color:inherit; cursor:pointer;
      transition:transform .06s ease,background .08s ease,box-shadow .08s ease;
    }
    button.key:active{transform:translateY(1px)}
    button.op{background:linear-gradient(90deg, rgba(56,189,248,0.12), rgba(56,189,248,0.06)); border:1px solid rgba(56,189,248,0.18); box-shadow:0 4px 14px rgba(56,189,248,0.06)}
    button.wide{grid-column:span 2}
    .meta{display:flex; justify-content:space-between; align-items:center; margin-top:12px; gap:12px}
    .hint{font-size:12px; color:var(--muted)}
    .history{margin-top:12px; background:rgba(255,255,255,0.02); padding:10px; border-radius:8px; max-height:140px; overflow:auto}
    .history p{margin:6px 0; font-size:13px; color:var(--muted)}
    @media (max-width:420px){ .display{font-size:18px} }
  </style>
</head>
<body>
  <main class="card" role="application" aria-label="Máy tính tối giản">
    <div class="title">Máy tính tối giản — chỉ + và -</div>
    <div class="display" id="display" aria-live="polite">
      <div class="expr" id="expr">0</div>
      <div class="result" id="result">0</div>
    </div>

    <div class="pad" role="group" aria-label="Các phím">
      <button class="key" data-key="7">7</button>
      <button class="key" data-key="8">8</button>
      <button class="key" data-key="9">9</button>
      <button class="key op" data-op="+" aria-label="Cộng">+</button>

      <button class="key" data-key="4">4</button>
      <button class="key" data-key="5">5</button>
      <button class="key" data-key="6">6</button>
      <button class="key op" data-op="-" aria-label="Trừ">−</button>

      <button class="key" data-key="1">1</button>
      <button class="key" data-key="2">2</button>
      <button class="key" data-key="3">3</button>
      <button class="key" data-key="0">0</button>

      <button class="key wide" id="clear">C</button>
      <button class="key wide op" id="equals">=</button>
    </div>

    <div class="meta">
      <div class="hint">Bạn có thể dùng phím số, Enter (=) và Backspace (xóa)</div>
      <div style="font-size:12px;color:var(--muted)">v1.0</div>
    </div>

    <div class="history" id="history" aria-live="polite"></div>
  </main>

  <script>
    (function(){
      const exprEl = document.getElementById('expr');
      const resultEl = document.getElementById('result');
      const historyEl = document.getElementById('history');

      let expr = '';

      function render(){
        exprEl.textContent = expr || '0';
        try{
          // evaluate only + and - safely
          const safe = expr.replace(/[^0-9+\-\s]/g,'');
          const res = safe === '' ? 0 : Function('return ('+safe+')')();
          resultEl.textContent = Number.isFinite(res) ? res : 'Err';
        }catch(e){ resultEl.textContent = 'Err' }
      }

      function pushKey(k){
        // append digit
        if(/[0-9]/.test(k)){
          expr += k;
        }
        render();
      }

      function pushOp(op){
        if(!expr) expr = '0';
        // prevent duplicate ops
        expr = expr.replace(/[+\-]+$/,'') + op;
        render();
      }

      function clearAll(){ expr=''; render(); }

      function equals(){
        try{
          const safe = expr.replace(/[^0-9+\-\s]/g,'');
          const res = safe === '' ? 0 : Function('return ('+safe+')')();
          addHistory(expr+' = '+res);
          expr = String(res);
          render();
        }catch(e){ resultEl.textContent='Err' }
      }

      function addHistory(text){
        const p = document.createElement('p'); p.textContent = text; historyEl.prepend(p);
        // keep history short
        while(historyEl.children.length>30) historyEl.removeChild(historyEl.lastChild);
      }

      // button events
      document.querySelectorAll('button.key').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const k = btn.dataset.key;
          const op = btn.dataset.op;
          if(k) pushKey(k);
          else if(op) pushOp(op);
        });
      });
      document.getElementById('clear').addEventListener('click', ()=>{ clearAll(); });
      document.getElementById('equals').addEventListener('click', ()=>{ equals(); });

      // keyboard
      window.addEventListener('keydown', (e)=>{
        if(e.key >= '0' && e.key <= '9'){ pushKey(e.key); e.preventDefault(); }
        else if(e.key === '+' || e.key === '-'){ pushOp(e.key); e.preventDefault(); }
        else if(e.key === 'Enter' || e.key === '='){ equals(); e.preventDefault(); }
        else if(e.key === 'Backspace'){ expr = expr.slice(0,-1); render(); e.preventDefault(); }
        else if(e.key.toLowerCase()==='c' && (e.ctrlKey||e.metaKey)){ clearAll(); }
      });

      // init
      render();
    })();
  </script>
</body>
</html>
